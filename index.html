<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Happy Birthday</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&family=Nunito:wght@700;800&family=Poppins:wght@600;700&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
/* ğŸ› ï¸ FIXED: Cleaned up variable definitions using standard spacing */
:root {
  --bg: #ffe9ee; 
  --grid: #ffdbe3; 
  --ink: #111;
  --pill: #ff5a71; 
  --pill-d: #db4257; 
  --ring: #0d0d0d; 
  --white: #fff;
}

* {
  box-sizing: border-box
}

html, body {
  height: 100%;
  margin: 0
}

body {
  background: var(--bg);
  font-family: 'Baloo 2', system-ui;
  color: #222;
  overflow: hidden
}

/* NEW VIDEO OVERLAY STYLES */
.video-overlay {
  position: fixed;
  inset: 0;
  z-index: 50;
  background: #000;
}

#introVideo {
  width: 100vw;
  height: 100vh;
  object-fit: cover;
}

/* PINK GRID */
.grid {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: linear-gradient(to right, var(--grid) 1px, transparent 1px) 0 0/40px 40px,
    linear-gradient(to bottom, var(--grid) 1px, transparent 1px) 0 0/40px 40px;
  opacity: .75
}

/* ===== BUNTING: two curved strings, flags hang, NO black bar ===== */
.bunting {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  height: 130px;
  pointer-events: none;
  z-index: 2
}

.bunting svg {
  width: 100%;
  height: 100%
}

.string {
  fill: none;
  stroke: #ff6e86;
  stroke-width: 8;
  stroke-linecap: round;
  filter: drop-shadow(0 4px 0 #ffb4c1)
}

.flag {
  filter: drop-shadow(0 1px 0 #0003)
}

/* soft shadow only, NO stroke outline */

/* Layout â€“ centered vertically */
.wrap {
  position: relative;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center
}

.stage {
  position: relative;
  width: min(1200px, 100vw);
  height: min(680px, 56.25vw)
}

.left {
  position: absolute;
  left: 5%;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 14px
}

.right {
  position: absolute;
  right: 6%;
  top: 50%;
  transform: translateY(-50%)
}

/* Title */
.row {
  display: flex;
  gap: 4px;
  align-items: flex-end;
  flex-wrap: wrap
}

.tile {
  display: grid;
  place-items: center;
  min-width: 58px;
  padding: 4px 10px;
  background: linear-gradient(#fff, #f6f8ff);
  border: 4px solid #111;
  border-radius: 14px;
  box-shadow: 0 8px 0 #0002;
  font-size: clamp(36px, 6.6vw, 92px);
  line-height: 1;
  font-weight: 800;
  color: #111;
  transform: translateY(40px);
  opacity: 0;
  letter-spacing: -0.02em
}

.coral {
  display: inline-block;
  font-size: clamp(36px, 6.6vw, 92px);
  font-weight: 800;
  color: #ff5a71;
  -webkit-text-stroke: 3px #111;
  filter: drop-shadow(0 6px 0 #0002);
  transform: translateY(40px);
  opacity: 0;
  letter-spacing: -0.03em
}

/* Cake after Birthday */
.cake {
  display: inline-block;
  margin-left: .25rem;
  font-size: clamp(30px, 4.2vw, 48px);
  transform-origin: 50% 100%;
  animation: cakeWiggle 2.2s ease-in-out infinite
}

@keyframes cakeWiggle {
  0%, 100% {
    transform: translateY(0) rotate(-6deg)
  }

  50% {
    transform: translateY(-4px) rotate(6deg)
  }
}

/* Hat on Y of Happy (bigger) */
.hat {
  position: absolute;
  width: clamp(36px, 5.6vw, 72px);
  height: clamp(36px, 5.6vw, 72px);
  left: 58%;
  top: -24%;
  transform-origin: 30% 90%;
  animation: hatSlide 2.6s ease-in-out infinite
}

@keyframes hatSlide {
  0%, 100% {
    transform: translateX(-6px) rotate(10deg)
  }

  50% {
    transform: translateX(4px) rotate(16deg)
  }
}

/* Button */
.pill {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 14px 26px;
  border-radius: 999px;
  background: var(--pill);
  color: #111;
  border: 3px solid #111;
  box-shadow: 0 8px 0 #0002, inset 0 -5px 0 var(--pill-d);
  font-family: 'Nunito';
  font-weight: 900;
  cursor: pointer
}

/* Avatar + name */
.avatar {
  width: clamp(250px, 34vw, 360px);
  height: clamp(250px, 34vw, 360px);
  border-radius: 50%;
  overflow: hidden;
  background: #ddd center/cover no-repeat;
  border: 8px solid var(--ring);
  box-shadow: 0 18px 40px #0002, 0 0 0 10px #0000000a inset;
  transform: scale(.86);
  opacity: 0
}

.nameTag {
  position: absolute;
  bottom: -34px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px 22px;
  border-radius: 999px;
  background: var(--pill);
  color: #111;
  border: 3px solid #111;
  font-family: 'Nunito';
  font-weight: 900;
  box-shadow: 0 8px 0 #0002, inset 0 -5px 0 var(--pill-d);
  opacity: 0
}

/* Glittering background (behind UI so it never covers texts) */
.sparkle {
  position: fixed;
  pointer-events: none;
  font-size: 28px;
  opacity: 0;
  text-shadow: 0 0 10px #fff6, 0 0 18px #ffd7;
  z-index: 1
}

/* Popup (MODIFIED FOR SLIDESHOW ON LEFT, TEXT ON RIGHT) */
.modalBack {
  position: fixed;
  inset: 0;
  background: #0005;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 30
}

.card {
  width: min(860px, 92vw);
  background: #fff7e9;
  color: #222;
  border-radius: 22px;
  border: 6px solid #fff;
  outline: 4px solid #222;
  padding: 18px 22px 24px;
  box-shadow: 0 18px 40px #0003;
  position: relative
}

.closeX {
  position: absolute;
  right: 8px;
  top: 6px;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid #222;
  display: grid;
  place-items: center;
  font-weight: 900;
  cursor: pointer;
  z-index: 31;
}

/* Two-column post layout (Original structure) */
.post {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  min-height: 360px;
  position: relative;
}

/* Left side (Image/Video Slideshow) */
.leftSticker {
  background: #ffe6ea;
  border: 3px solid #222;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 12px;
  position: relative; /* For arrow positioning */
  overflow: hidden;
}

/* New CSS for dynamic media content */
.leftSticker .media-content {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 10px;
  width: 100%; /* Ensure content takes full width */
  height: 100%; /* Ensure content takes full height */
}

/* Arrows for Navigation */
.nav-arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255, 255, 255, 0.75);
  border: 2px solid #222;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: grid;
  place-items: center;
  font-size: 24px;
  font-weight: 900;
  cursor: pointer;
  z-index: 10;
  box-shadow: 0 4px 0 #0002;
  transition: transform 0.1s ease;
}

.nav-arrow:active {
  transform: translateY(-50%) scale(0.95);
  box-shadow: none;
}

#prevBtn {
  left: 8px;
}

#nextBtn {
  right: 8px;
}

/* Right side (Text Message) */
.rightMsg {
  border-left: 3px solid #222;
  padding: 8px 8px 8px 18px;
  font-family: 'Nunito';
  position: relative;
  /* Ensure this has the vertical layout elements */
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.big-emoji {
  /* This is the heart/emoji container */
  font-size: 80px;
  text-align: center;
}

.rightMsg h3 {
  margin: 6px 0 12px;
  font-family: 'Baloo 2';
  font-size: 28px;
  text-align: center;
}

.rightMsg p {
  margin: 0;
  font-size: 18px;
  line-height: 1.55;
  white-space: pre-wrap;
  overflow-y: auto; /* Scroll if message is long */
}

/* Gate (gift.jpg) */
.gate {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: var(--bg);
  z-index: 20
}

.gateInner {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px
}

.giftWrap {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px
}

.giftImg {
  width: 220px;
  height: 220px;
  border-radius: 30px;
  overflow: hidden;
  position: relative;
  background: #ff9db0 center/cover no-repeat;
  border: 4px solid #111;
  box-shadow: 0 12px 0 #0002
}

.giftImg img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block
}

.bob {
  animation: bob 2.2s ease-in-out infinite
}

@keyframes bob {
  0%, 100% {
    transform: translateY(0)
  }

  50% {
    transform: translateY(6px)
  }
}

.sheen {
  position: absolute;
  inset: 0;
  border-radius: 30px;
  background: linear-gradient(120deg, #ffffff66 0 10%, transparent 10% 60%, #ffffff33 60% 68%, transparent 68% 100%);
  mix-blend-mode: screen;
  animation: sheen 2.8s linear infinite
}

@keyframes sheen {
  0% {
    background-position: -200% 0
  }

  100% {
    background-position: 200% 0
  }
}

/* Curved OPEN IT text above the gift (stencil arc) */
.openArc {
  position: absolute;
  top: -60px;
  left: 50%;
  transform: translateX(-50%);
  width: 260px;
  height: 100px;
  pointer-events: none
}

.openArc text {
  font-family: 'Monotype Corsiva', 'Great Vibes', 'Segoe Script', cursive;
  fill: #111;
  font-size: 34px;
  filter: drop-shadow(0 2px 0 #fff)
}

.openArc g {
  animation: pulseZoom 1.6s ease-in-out infinite
}

@keyframes pulseZoom {
  0%, 100% {
    transform: scale(1)
  }

  50% {
    transform: scale(1.08)
  }
}

/* Cursive label for name (no bullet) */
.typeLabel {
  font-family: 'Monotype Corsiva', 'Great Vibes', 'Segoe Script', cursive;
  font-size: 28px;
  font-weight: 700;
  letter-spacing: .3px;
  background: #fff;
  border: 3px solid #111;
  padding: 10px 18px;
  border-radius: 14px;
  box-shadow: 0 8px 0 #0002
}

.nameInput {
  padding: 12px 14px;
  border-radius: 12px;
  border: 3px solid #111;
  font-family: 'Nunito';
  font-weight: 800;
  width: min(360px, 80vw);
  background: #fff
}
</style>
</head>
<body>

<div class="video-overlay" id="videoOverlay">
    <video id="introVideo" autoplay muted playsinline>
        <source src="video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>

<div class="grid"></div>

<div class="bunting">
Â  <svg viewBox="0 0 1200 130" preserveAspectRatio="none">
Â  Â  <defs>
Â  Â  Â  <linearGradient id="triPink" x1="0" y1="0" x2="0" y2="1">
Â  Â  Â  Â  <stop offset="0" stop-color="#ff8fa3"/><stop offset="1" stop-color="#ff5a71"/>
Â  Â  Â  </linearGradient>
Â  Â  Â  Â  Â  Â  <polygon id="tri" class="flag" points="0,0 26,0 13,30" fill="url(#triPink)"/>
Â  Â  Â  <polygon id="triL" class="flag" points="0,0 26,0 13,30" fill="#ffd4db"/>
Â  Â  </defs>

Â  Â  Â  Â  <path id="leftStr"Â  class="string" d="M-40,78 Q260,12 520,70" />
Â  Â  <path id="rightStr" class="string" d="M680,70 Q940,12 1240,78" />

Â  Â  Â  Â  <g>
Â  Â  Â  <use href="#tri"Â  transform="translate(10,66) rotate(-6)"/>
Â  Â  Â  <use href="#triL" transform="translate(50,62) rotate(-7)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(90,60) rotate(-8)"/>
Â  Â  Â  <use href="#triL" transform="translate(130,58) rotate(-9)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(170,56) rotate(-10)"/>
Â  Â  Â  <use href="#triL" transform="translate(210,55) rotate(-11)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(250,54) rotate(-12)"/>
Â  Â  Â  <use href="#triL" transform="translate(290,54) rotate(-13)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(330,55) rotate(-14)"/>
Â  Â  Â  <use href="#triL" transform="translate(370,57) rotate(-16)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(410,60) rotate(-18)"/>
Â  Â  Â  <use href="#triL" transform="translate(450,63) rotate(-20)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(490,66) rotate(-22)"/>
Â  Â  </g>

Â  Â  Â  Â  <g>
Â  Â  Â  <use href="#tri"Â  transform="translate(700,66) rotate(6)"/>
Â  Â  Â  <use href="#triL" transform="translate(740,63) rotate(8)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(780,60) rotate(10)"/>
Â  Â  Â  <use href="#triL" transform="translate(820,58) rotate(11)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(860,56) rotate(12)"/>
Â  Â  Â  <use href="#triL" transform="translate(900,55) rotate(13)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(940,54) rotate(14)"/>
Â  Â  Â  <use href="#triL" transform="translate(980,55) rotate(15)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(1020,56) rotate(16)"/>
Â  Â  Â  <use href="#triL" transform="translate(1060,58) rotate(17)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(1100,60) rotate(18)"/>
Â  Â  Â  <use href="#triL" transform="translate(1140,63) rotate(19)"/>
Â  Â  Â  <use href="#tri"Â  transform="translate(1180,66) rotate(21)"/>
Â  Â  </g>
Â  </svg>
</div>

<div class="gate" id="gate">
Â  <div class="gateInner">
Â  Â  <div class="giftWrap">
Â  Â  Â  Â  Â  Â  <svg class="openArc" viewBox="0 0 260 100">
Â  Â  Â  Â  <defs><path id="arcPath" d="M20,80 Q130,18 240,80"/></defs>
Â  Â  Â  Â  <g><text><textPath href="#arcPath" startOffset="50%" text-anchor="middle">Open it ğŸ</textPath></text></g>
Â  Â  Â  </svg>

Â  Â  Â  <div class="giftImg bob" id="giftBox">
Â  Â  Â  Â  <img src="gift.jpg?v=4" alt="gift">
Â  Â  Â  Â  <div class="sheen"></div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div class="typeLabel" id="typeLabel"></div>
Â  Â  <input class="nameInput" id="nameInput" placeholder="Type hereâ€¦" />
Â  </div>
</div>

<div class="wrap">
Â  <div class="stage" id="scene" style="visibility:hidden">
Â  Â  <div class="left">
Â  Â  Â  <div class="row" id="rowHappy"></div>
Â  Â  Â  <div class="row" id="rowBirth"></div>
Â  Â  Â  <div class="pill" id="openCard">ğŸ’Œ A Sweet message to my <span class="bestieFirst">Likki Bondam</span> ğŸ’Œ</div>
Â  Â  </div>
Â  Â  <div class="right">
Â  Â  Â  <div class="avatar" id="avatar"><img src="bestie.png" alt="" style="width:100%;height:100%;object-fit:cover"></div>
Â  Â  Â  <div class="nameTag" id="nameTag"><span class="bestieName">Likhitha</span> â™¥</div>
Â  Â  Â  </div>
Â  Â  </div>
</div>

<div id="sparkLayer"></div>

<div class="modalBack" id="modal">
  <div class="card" role="dialog" aria-modal="true">
    <button class="closeX" id="closeX">âœ•</button>
    
    <div class="post">
      
      <div class="leftSticker" id="leftStickerContent">
        <button class="nav-arrow" id="prevBtn">â®</button>
        <button class="nav-arrow" id="nextBtn">â¯</button>
      </div>

      <div class="rightMsg">
        <div class="big-emoji">â¤ï¸</div>
        
        <h3 id="typeTitle"></h3>
        <p id="typeBody"></p>
      </div>
    </div>
  </div>
</div>

<audio id="bgm" src="ringtone.mp3" loop></audio>

<script>
/* ===== CONFIG - UPDATED FOR 9 PICTURES AND 1 FINAL VIDEO ===== */
const CONFIG = {
Â  bestieName: "Likhitha",
Â  buttonName: "Likki Bondam",
Â  photoPath: "bestie.png?v=9",
Â  giftPath:Â  "gift.jpg?v=4",
Â  unlockWord: "bondam",
Â  happy: "Happy",
Â  birthday: "Birthday",
  // Single text block content that applies to ALL images/videos
  staticTitle: "ğŸ’– To My little cutie moti patootie pookie wookie little sugary kuchu puchu LIKHITHA ğŸ’–",
  staticBody:
`Happy Birthday to the most beautiful thing that has ever happened to me! 
 My love, you are such a special girl; you are super caring, incredibly sweet, and so wonderfully pretty, and I am completely falling for you because I have never met anyone more PERFECT than you. 
 I silently thank you every day for coming into my life. 
 Being with you brings me such profound peace and happiness; you are the source of my joy, and in my eyes, you are the most exquisite girl in the world. 
 Today, I wish you all the best, lots of health, and lots of joy, and I sincerely hope weâ€™ll celebrate many more birthdays like this together. 
 I miss you a lot, and please know that: The moon is very beautiful, isnâ€™t it? ğŸ’—`,
Â  sparklesPerSecond: 18,
Â  sparkSet: ["âœ¨","ğŸŒŸ","ğŸ’–","ğŸ’«","ğŸª„","â­","ğŸˆ","ğŸ¬","ğŸ’—","ğŸ€","ğŸ‰","ğŸ’•","ğŸ’"],
  
  // *** Gallery Items (Total 10 slides: 9 images + 1 video) ***
  galleryItems: [
    { type: "image", src: "pic1.jpg" }, 
    { type: "image", src: "pic2.jpg" }, 
    { type: "image", src: "pic3.jpg" }, 
    { type: "image", src: "pic4.jpg" }, 
    { type: "image", src: "pic5.jpg" },
    { type: "image", src: "pic6.jpg" }, // New picture 6
    { type: "image", src: "pic7.jpg" }, // New picture 7
    { type: "image", src: "pic8.jpg" }, // New picture 8
    { type: "image", src: "pic9.jpg" }, // New picture 9
    { type: "video", src: "last-video.mp4" } // New video at the end
  ]
};

/* ===== typewriter (Unchanged) ===== */
function typewrite(el, text, speed=28, done){ el.textContent=''; let i=0;
Â  const t=setInterval(()=>{ el.textContent+= text[i++] || ''; if(i>text.length){clearInterval(t); done&&done();}}, speed);}

/* ===== Sparkles everywhere (Unchanged) ===== */
const sparkLayer = document.getElementById('sparkLayer');
function sparkle(){
Â  const s=document.createElement('div'); s.className='sparkle';
Â  s.textContent=CONFIG.sparkSet[Math.floor(Math.random()*CONFIG.sparkSet.length)];
Â  s.style.left=Math.random()*innerWidth+'px';
Â  s.style.top=Math.random()*innerHeight+'px';
Â  s.style.transform=`scale(${0.6+Math.random()*1.3}) rotate(${Math.random()*40-20}deg)`;
Â  sparkLayer.appendChild(s);
Â  requestAnimationFrame(()=> s.style.transition='opacity .16s ease');
Â  s.style.opacity=1;
Â  setTimeout(()=> s.style.opacity=0, 360+Math.random()*520);
Â  setTimeout(()=> s.remove(), 1200);
}
setInterval(sparkle, 1000/CONFIG.sparklesPerSecond);

/* ===================================== */
/* ===== Audio autoplay (FIXED) ===== */
/* ===================================== */
const bgm=document.getElementById('bgm');
function tryPlay(){ bgm.play().catch(()=>{}); }

// **--- FIX: Call tryPlay() immediately on script load ---**
tryPlay(); 

// Keep interaction listeners as a fallback if the browser requires a click/tap
['click','touchstart','keydown'].forEach(evt=>document.addEventListener(evt,tryPlay,{once:false}));

/* ===================================== */
/* ===== VIDEO & GATE HANDLING (Unchanged) ===== */
/* ===================================== */
const videoOverlay = document.getElementById('videoOverlay');
const introVideo = document.getElementById('introVideo');
const gate = document.getElementById('gate');
const typeLabel = document.getElementById('typeLabel');
const nameInput = document.getElementById('nameInput');

function playIntroVideo() {
    introVideo.play().catch(e => console.log("Video autoplay failed (browser restrictions). Waiting for user interaction.", e));
}

introVideo.onended = () => {
    videoOverlay.style.transition = "opacity .5s ease";
    videoOverlay.style.opacity = 0;
    setTimeout(() => {
        videoOverlay.style.display = 'none';
        gate.style.display = 'flex';
        typewrite(typeLabel, "Enter your name", 22);
    }, 500);
};

playIntroVideo(); 


let wrong = 0;
nameInput.addEventListener('keydown', (e)=>{
Â  if(e.key!=="Enter") return;
Â  const v = (nameInput.value||'').trim().toLowerCase();
Â  if(v === CONFIG.unlockWord.toLowerCase()){
Â  Â  gate.style.transition="opacity .45s ease"; gate.style.opacity=0;
Â  Â  setTimeout(()=>{ gate.style.display="none"; startScene(); }, 450);
Â  }else{
Â  Â  wrong++;
Â  Â  typeLabel.textContent = wrong===1 ? "Idhi kadhu ra.. nen pettina name!"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : "Haha, oorike cheppa le. Nuv nannu pilche name try chey.";
Â  Â  nameInput.value = ""; // clear (no highlight)
Â  }
});
/* ===================================== */


/* ===== Build title and start scene (Unchanged) ===== */
const rowHappy = document.getElementById('rowHappy');
const rowBirth = document.getElementById('rowBirth');

function buildWord(container, word, style){
Â  container.innerHTML='';
Â  [...word].forEach(ch=>{
Â  Â  const span=document.createElement('span');
Â  Â  span.className=style;
Â  Â  span.textContent= ch===' ' ? '\u00A0' : ch;
Â  Â  container.appendChild(span);
Â  });
}

function animateWord(container, placeHatOnY=false){
Â  const letters=[...container.children];
Â  letters.forEach((el,i)=>{
Â  Â  setTimeout(()=>{
Â  Â  Â  el.style.transition="transform .55s cubic-bezier(.17,.67,.27,1.35), opacity .5s";
Â  Â  Â  el.style.transform="translateY(0)"; el.style.opacity=1;
Â  Â  Â  setTimeout(()=>el.style.transform="translateY(-6px)",520);
Â  Â  Â  setTimeout(()=>el.style.transform="translateY(0)",740);

Â  Â  Â  if(placeHatOnY && el.textContent.toLowerCase()==='y'){
Â  Â  Â  Â  const hat=document.createElementNS("http://www.w3.org/2000/svg","svg");
Â  Â  Â  Â  hat.setAttribute("viewBox","0 0 100 100"); hat.classList.add("hat");
Â  Â  Â  Â  hat.innerHTML=`<defs>
Â  Â  Â  Â  Â  Â  <linearGradient id="cone" x1="0" y1="0" x2="1" y2="1">
Â  Â  Â  Â  Â  Â  Â  <stop offset="0" stop-color="#0b2a4a"/><stop offset="1" stop-color="#ff5a71"/>
Â  Â  Â  Â  Â  Â  </linearGradient>
Â  Â  Â  Â  Â  Â  <filter id="hshadow"><feDropShadow dx="0" dy="3" stdDeviation="2" flood-color="#000" flood-opacity=".35"/></filter>
Â  Â  Â  Â  Â  </defs>
Â  Â  Â  Â  Â  <polygon points="50,6 92,92 8,92" fill="url(#cone)" stroke="#111" stroke-width="6" filter="url(#hshadow)"/>
Â  Â  Â  Â  Â  <circle cx="92" cy="8" r="10" fill="#111"/>`;
Â  Â  Â  Â  el.style.position='relative'; el.appendChild(hat);
Â  Â  Â  }
Â  Â  }, 110*i);
Â  });
}

/* ===== Avatar + name (Unchanged) ===== */
const avatar = document.getElementById('avatar');
const nameTag = document.getElementById('nameTag');

/* ===== Start scene (Unchanged) ===== */
function startScene(){
Â  Â  buildWord(rowHappy, CONFIG.happy, 'tile');
Â  Â  buildWord(rowBirth, CONFIG.birthday, 'coral');

Â  Â  // add a moving cake after "Birthday"
Â  Â  const cake = document.createElement('span');
Â  Â  cake.className = 'cake';
Â  Â  cake.textContent = 'ğŸ°';
Â  Â  rowBirth.appendChild(cake);

Â  Â  document.querySelector('.bestieName').textContent = CONFIG.bestieName;
Â  Â  document.querySelector('.bestieFirst').textContent = CONFIG.buttonName;
Â  Â  avatar.querySelector('img').src = CONFIG.photoPath;

Â  Â  document.getElementById('scene').style.visibility='visible';

Â  Â  animateWord(rowHappy, true); // hat on Y
Â  Â  setTimeout(()=>animateWord(rowBirth,false), 110*CONFIG.happy.length + 240);

Â  Â  setTimeout(()=>{
Â  Â  Â  avatar.style.transition="transform 1s ease, opacity 1s ease";
Â  Â  Â  nameTag.style.transition="opacity .8s ease .3s";
Â  Â  Â  avatar.style.transform="scale(1)"; avatar.style.opacity=1; nameTag.style.opacity=1;
Â  Â  }, 110*(CONFIG.happy.length+CONFIG.birthday.length) + 700);
}


/* ===================================== */
/* ===== GALLERY / SLIDESHOW LOGIC ===== */
/* ===================================== */
const modal=document.getElementById('modal'); 
const openCard=document.getElementById('openCard');
const closeX=document.getElementById('closeX'); 
// const galleryImage = document.getElementById('galleryImage'); // No longer needed as we use the container
const leftStickerContent = document.getElementById('leftStickerContent');
const typeTitle = document.getElementById('typeTitle'); 
const typeBody = document.getElementById('typeBody');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');

let currentSlide = 0;
let messageTyped = false;

function updateGallery(index) {
  const item = CONFIG.galleryItems[index];
  
  // Clear previous content
  leftStickerContent.innerHTML = '';
  
  let mediaElement;

  if (item.type === "image") {
      mediaElement = document.createElement('img');
      mediaElement.src = item.src;
      mediaElement.alt = `Gallery Image ${index + 1}`;
      mediaElement.classList.add('media-content');
      
  } else if (item.type === "video") {
      mediaElement = document.createElement('video');
      mediaElement.src = item.src;
      mediaElement.classList.add('media-content');
      mediaElement.autoplay = true;
      mediaElement.loop = true;
      mediaElement.controls = true;
  }

  // Add the media element to the container
  leftStickerContent.appendChild(mediaElement);

  // Re-add navigation buttons
  leftStickerContent.appendChild(prevBtn);
  leftStickerContent.appendChild(nextBtn);
  
  // Disable/enable arrows
  prevBtn.disabled = index === 0;
  nextBtn.disabled = index === CONFIG.galleryItems.length - 1;
  prevBtn.style.opacity = index === 0 ? 0.5 : 1;
  nextBtn.style.opacity = index === CONFIG.galleryItems.length - 1 ? 0.5 : 1;
}

// Click to Open Gallery
openCard.addEventListener('click', ()=>{
Â  modal.style.display='flex';
  currentSlide = 0; // Start at the first picture
Â  updateGallery(currentSlide);
  
  // Type the message only once when the gallery is opened
  if (!messageTyped) {
    typeTitle.textContent = ''; 
    typeBody.textContent = ''; 
    typewrite(typeTitle, CONFIG.staticTitle, 42, () => {
      typewrite(typeBody, CONFIG.staticBody, 18, () => {
        messageTyped = true;
      });
    });
  }
});

// Navigation Handlers
prevBtn.addEventListener('click', () => {
  if (currentSlide > 0) {
    currentSlide--;
    updateGallery(currentSlide);
  }
});

nextBtn.addEventListener('click', () => {
  if (currentSlide < CONFIG.galleryItems.length - 1) {
    currentSlide++;
    updateGallery(currentSlide);
  }
});

// Close Modal (Popup)
closeX.addEventListener('click', ()=> modal.style.display='none');
modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.style.display='none';});
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.style.display==='flex') modal.style.display='none';});
</script>
</body>
</html>
